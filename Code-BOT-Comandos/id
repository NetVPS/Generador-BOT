#!/bin/bash
[[ -d /root/RegBOT ]] || mkdir /root/RegBOT
send_ID () {
MSG_id=$((${message_message_id} + 1 ))
[[ -z ${callback_query_from_first_name} ]] && firsnme="${message_from_first_name}" || firsnme="${callback_query_from_first_name}"
[[ -z ${callback_query_from_last_name} ]] && lastnme="${message_from_last_name}" || lastnme="${callback_query_from_last_name}"
[[ -z ${callback_query_from_username} ]] && nUSER=${message_from_username} || nUSER=${callback_query_from_username}
[[ -e /root/RegBOT/U_check.txt ]] && n_soli=$(cat /root/RegBOT/U_check.txt | grep ${chatuser} | wc -l) || n_soli=1
[[ $n_soli < 2 ]] && {
echo "${chatuser}" >> /root/RegBOT/U_check.txt
          bot_retor="$LINE\n"
          bot_retor+=" Cliente ã€ ${firsnme} ${lastnme} ã€\n"
		  [[ -z ${nUSER} ]] && bot_retor+=" âš ï¸ USUARIO SIN ALIAS âš ï¸\n" || bot_retor+=" <u> ALIAS</u>: @${nUSER} CON $n_soli INTENTOS\n"
		  bot_retor+="$LINE\n"
		  bot_retor+=" FORMATO $MSG_id <tg-spoiler>${chatuser}</tg-spoiler> | <u>DIAS</u> \n"
          bot_retor+=" PARA ACEPTAR DA CLICK AQUI ğŸ‘‰ /add , LUEGO\n"
          bot_retor+=" PARA 4 DIAS COPY ğŸ‘‰ <code>${chatuser} | 4</code> \n"
          bot_retor+=" PARA 7 DIAS COPY ğŸ‘‰ <code>${chatuser} | 7</code> \n"
          bot_retor+=" PARA 15 DIAS COPY ğŸ‘‰ <code>${chatuser} | 15</code> \n"
          bot_retor+=" PARA 30 DIAS COPY ğŸ‘‰ <code>${chatuser} | 30</code> \n"
          bot_retor+=" PARA 60 DIAS COPY ğŸ‘‰ <code>${chatuser} | 60</code> \n"
          bot_retor+=" PARA 90 DIAS COPY ğŸ‘‰ <code>${chatuser} | 90</code> \n"
          bot_retor+=" PARA 180 DIAS COPY ğŸ‘‰ <code>${chatuser} | 179</code> \n"
          bot_retor+=" PARA 1 AÃ‘O COPY ğŸ‘‰ <code>${chatuser} | 364</code> \n"
		  bot_retor+=" CUSTOM COPY ğŸ‘‰ â™¨ï¸ <code>${chatuser} | dias</code> â™¨ï¸\n"
          bot_retor+="$LINE\n"
          bot_retor+=" VERIFIQUE SU TOKEN DE PAGO ANTES DE LA AUTORIZACION\n"
          bot_retor+="$LINE\n"
		  msj_add "$(cat < ${CIDdir}/Admin-ID)"
    	bot_retorno="$LINE\n"
        bot_retorno+=" ğŸ”° ğš‚ğš ğ™¸ğ™³ ã€ <code>${chatuser}</code> ã€‘ ğŸ”°\n"
        bot_retorno+="$LINE\n"
        [[ -z ${nUSER} ]] && bot_retorno+=" âš ï¸ AÃ‘ADA UN ALIAS PARA PODER SOLICITAR âš ï¸\n" || bot_retorno+="UD SOLICITO AUTORIZACION A $(cat < /etc/ADM-db/resell)\n"
        [[ -z ${nUSER} ]] && bot_retorno+="   IMPOSIBLE VERIFICAR ID SIN ALIAS\n  REMARCA SU ${n_soli} SOLITUD INVALIDA \n" || bot_retorno+=" ESTA ES SU ${n_soli} SOLICITUD MEDIANTE ID DE REGISTRO\n"
        bot_retorno+="$LINE\n"
        [[ -z ${nUSER} ]] && bot_retorno+=" âš  ID ENVIADO CON ADVERTENCIA (POSIBLE BANEO DE ID) âš ï¸\n" || bot_retorno+="      âœ… ID ENVIADO EXITOSAMENTE âœ…\n"
        bot_retorno+="$LINE\n"
		bot_retorno+=" ENVIE SU COMPROBANDO O CORREO DE PAGO PARA SU AUTORIZACION\n"
		bot_retorno+="$LINE\n"
		msj_fun
			} || {
				bot_retorno="$LINE\n"
				bot_retorno+=" ğŸ”° ğš‚ğš ğ™¸ğ™³ ã€ <code>${chatuser}</code> ã€‘ ğŸ”°\n"
				bot_retorno+="$LINE\n"
				[[ -z ${nUSER} ]] && bot_retorno+=" âš ï¸ USUARIO SIN ALIAS âš ï¸\n" || bot_retorno+=" <u> ALIAS</u>: @${nUSER} CON ID : <code>${chatuser}</code>\n"
				[[ -z ${nUSER} ]] && bot_retorno+=" âš ï¸ AÃ‘ADA UN ALIAS PARA PODER SOLICITAR âš ï¸\n" || bot_retorno+=" UD ENVIO ${n_soli} SOLICITUDES A $(cat < /etc/ADM-db/resell)\n"
				[[ -z ${nUSER} ]] && bot_retorno+="   IMPOSIBLE VERIFICAR ID SIN ALIAS\n  REMARCA SU ${n_soli} SOLITUD INVALIDA \n" || bot_retorno+=" SU PETICION FUE RECHAZADA POR EXCESO DE PETICIONES\n"
				bot_retorno+="     ğŸš«ğŸš«ï¸ SU ID FUE BANEADO ğŸš«ğŸš« \n"
				bot_retorno+="$LINE\n"
				echo "${chatuser}" >> /root/RegBOT/banID
		bot_retorno+="        âšœ Power by @ChumoGH âšœ\n"
		bot_retorno+="$LINE\n"
		msj_fun
	}
}

myid_src () {
MSG_id=$((${message_message_id} + 1 ))
[[ -z ${callback_query_from_username} ]] && nUSER=${message_from_username} || nUSER=${callback_query_from_username}
[[ ! -z $(cat /etc/ADM-db/Admin-ID|grep "${chatuser}" ) ]] && { #ENTRA A VERIFICAR ADM
bot_retorno="  $LINE\n"
bot_retorno+=" HOLA @${nUSER} UD ES ADM \n"
bot_retorno+="$LINE\n"
bot_retorno+=" DIJITA MENU /menu   ğŸ”°\n"
bot_retorno+="\n"
bot_retorno+="$LINE\n"
bot_retorno+="        âšœ Power by @ChumoGH âšœ\n"
bot_retorno+="$LINE\n"
#bot_retorno+="<b>bold</b>, <strong> bold</strong> \n
#<i>italic</i>, <em>italic</em>\n"
bot_retorno+=" <pre>BORRAREMOS ESTE PRE ${message_message_id} </pre>\n"
bot_retorno+=" <code>BORRAREMOS ESTE CODE ${MSG_id} </code>\n"
msj_fun
sleep 5s
msj_del ${message_message_id}
msj_del ${MSG_id}
} || { # SINO ES ADM - CAMBIA A USUARIOS AUTORIZADOS
	[[ $(cat ${CID}|grep "${chatuser}" ) = "" ]] && { # ENTRA A VERIFCAR USUARIOS QUE NO EXISTEN
		bot_retorno="$LINE\n"
		[[ -z ${nUSER} ]] && bot_retorno+=" âš ï¸ USUARIO SIN ALIAS âš ï¸\n" || bot_retorno+="ğ™ƒğ™¤ğ™¡ğ™– ã€ @${nUSER} ã€‘, SU ID NO ESTA AUTORIZADO\n"
		bot_retorno+="  ADQUIERE UNA MENBRESIA O DIJITA /prices \n"
		bot_retorno+=" VISITA LA TIENDA ğŸ›’ğŸ›ï¸ PINCHANDO ğŸ‘‰<a href='https://shoppy.gg/@ChumoGH/'>AQUI</a>ğŸ‘ˆ\n"
        bot_retorno+="$LINE\n"
        bot_retorno+="ğš‚ğš ğ™¸ğ™³ ã€ <code>${chatuser}</code> ã€‘\n"
        bot_retorno+="$LINE\n"
        bot_retorno+="ğŸ‘‡PINCHA ğŸ‘‡ EN EL BOTON PARA QUE $(cat < /etc/ADM-db/resell) TE AUTORICE!!\n"
        bot_retorno+="$LINE\n"
		menu_printSN
		sleep 5s
		msj_del ${message_message_id}
		msj_del ${MSG_id}
	} || { # ENTRA A  IDS YA REGISTRADOS
			bot_retorno="  $LINE\n"
			bot_retorno+=" HOLA @${nUSER} SU ID ESTA REGISTRADO \n"
			bot_retorno+="$LINE\n"
			bot_retorno+="    ğŸ†” : <code>${chatuser}</code> ğŸ”°\n"
			bot_retorno+=" FECHA DE CORTE : â³ $(cat /etc/ADM-db/User-ID | grep ${chatuser}| awk '{print $3}') | $(date +%R)\n"
			bot_retorno+="\n"
			bot_retorno+="$LINE\n"
			bot_retorno+="        âšœ Power by @ChumoGH âšœ\n"
			bot_retorno+="$LINE\n"
			msj_fun
		}
						} # FIN VERIFICAR ADM
}

killIP_reply () {

if sed -i "/${message_text[$id]}/d" /var/www/html/ChumoGH/checkIP.log; then
bot_retorno="$LINE\n"
bot_retorno+="  IP ELIMINADA DE REGISTRO EXITOSAMENTE!\n"
bot_retorno+="  IP : ${message_text[$id]} \n"
bot_retorno+="$LINE\n"
else
bot_retorno="$LINE\n"
bot_retorno+="  ERROR AL ELIMINAR IP DE REGISTROS \n"
bot_retorno+="  POSIBLEMENTE ${message_text[$id]} NO EXISTA \n"
bot_retorno+="$LINE\n"
fi
msj_fun
}

deleteID_reply () {
ids=$(echo ${message_text[$id]} | awk '{print $1}' | sed -e 's/[^a-z0-9 -]//ig')
idc=$(echo ${message_text[$id]} | awk '{print $3}' | sed -e 's/[^a-z0-9 -]//ig')
sed -i "${message_text[$id]}/d" ${CID}
bot_retorno="$LINE\n"
          bot_retorno+=" ID ELIMINADO EXITOSAMENTE!\n"
          bot_retorno+=" ID Eliminado: ${ids}\n"
          bot_retorno+="$LINE\n"
			
          bot_retor="  ğŸŠ ğ™±ğš’ğšğš—ğšŸğšğš—ğš’ğšğš˜  Nuevamente ğšŠğš•  ğ™±ğš˜ğšğ™¶ğšğš—  ğ™²ğš‘ğšğš–ğš˜ğ™¶ğ™·-ğ™°ğ™³ğ™¼  ğŸŠ\n"
          #bot_retor+="ğ™ƒğ™¤ğ™¡ğ™– ã€ $message_from_first_name $message_from_last_name ã€\n"
          bot_retor+="Desafortunadamente tu Membresia ha Finalizado\n"
          #bot_retor+=" âŒšâŒš Hora Actual del Bot : âŒšâŒš\n"
          bot_retor+="Fecha de Corte : $(date '+%C%y-%m-%d') - $(date +%R)  \n"
          bot_retor+="Si tienes Dudas, Contacta con $(cat < /etc/ADM-db/resell)\n"
          bot_retor+="$LINE\n"
          bot_retor+="Recuerda adquirir creditos, o Realizar una Colaboracion\n $(cat < /etc/mpayu) \n"
          bot_retor+="Para mantener tu acceso al BotGen Recuerda Mostrar tu Token de Donacion o Compra\n"
          bot_retor+="$LINE\n"
      msj_fun
      msj_add ${ids}
      upfile_src
}

img_reply () {
local file_id
          ShellBot.getFile --file_id ${message_document_file_id[$id]}
          ShellBot.downloadFile --file_path "${return[file_path]}" --dir "/root/"
		  [[ -e ${return[file_path]} ]] && mv ${return[file_path]} "/root/"
local bot_retorno="ID user botgen\n"
		bot_retorno+="$LINE\n"
		bot_retorno+=" FILE ${return[file_path]} \n"
		bot_retorno+="$LINE"
ID_img=${message_photo_file_unique_id}
          bot_retorno+=" CALCULANDO ID DE MENSAJES \n"
          bot_retorno+=" ID FILE PHOTO : ${message_photo_file_id}\n"
		  bot_retorno+="$LINE\n"
          bot_retorno+=" ID UNICO FILE PHOTO : ${message_photo_file_unique_id}\n"
          bot_retorno+=" CAPTION : ${message_caption}\n"
          bot_retorno+="$LINE\n"
      msj_fun
      #upfile_src
	  msj_img "${ID_img}"
}

searchID_reply () {
searchID=$(cat -n /etc/ADM-db/User-ID | grep "${message_text[$id]}")
bot_retorno="$LINE\n"
        bot_retorno+=" MOSTRANDO RESULTADOS DE BUSQUEDA!\n"
		bot_retorno+=" $LINE\n"
		[[ ! -z ${searchID} ]] && bot_retorno+=" NÂ°${searchID} \n" || bot_retorno+=" ID NO ENCONTRADO \n"
      msj_fun
}

addID_reply () {
      ids=$(echo ${message_text[$id]} | awk '{print $1}' | sed -e 's/[^a-z0-9 -]//ig')
        idc=$(echo ${message_text[$id]} | awk '{print $3}' | sed -e 's/[^a-z0-9 -]//ig')
        valid=$(date '+%C%y-%m-%d' -d " +$idc days")
	  [[ $(cat ${CID}|grep "$ids" ) = "" ]] && {
		[[ -e /root/RegBOT/banID ]] && sed -i "/${ids}/d" /root/RegBOT/banID
        echo "/${ids} | $valid" >> ${CID}
        echo "/${ids} | $(date '+%C%y-%m-%d') | $(date +%R)" >> ${CID}.reg
          bot_retorno="  âœ‰ï¸ REGISTRO ACEPTADO  âœ‰ï¸ \n"
          bot_retorno+=" ğŸ†” : ${ids} | ACEPTADO ğŸ§¾\n"
          bot_retorno+="$LINE\n"
          bot_retorno+=" FECHA DE REGISTRO : $(date '+%C%y-%m-%d')|$(date +%R) \n VALIDO HASTA : ${valid}|$(date +%R)\n"
          bot_retorno+="$LINE\n"
          bot_retorno+="  âœ… ID REGISTRADO EXITOSAMENTE âœ…\n"
          bot_retorno+="$LINE\n"
          bot_retorno+="        âšœ Power by @ChumoGH âšœ\n"
unset i
for i in $(cat /etc/ADM-db/User-ID | awk '{print $3}'); do 
[[ "$(date -d $(date '+%C%y-%m-%d') +%s)" -ge "$(date -d $i +%s)" ]] && {
for id in $(cat /etc/ADM-db/User-ID | grep "$i" | awk '{print $1}' | sed -e 's/[^a-z0-9 -]//ig'); do
sed -i "/${id}/d" /etc/ADM-db/User-ID
          bot_retor="  ğŸŠ ğ™±ğš’ğšğš—ğšŸğšğš—ğš’ğšğš˜  Nuevamente ğšŠğš•  ğ™±ğš˜ğšğ™¶ğšğš—  ğ™²ğš‘ğšğš–ğš˜ğ™¶ğ™·-ğ™°ğ™³ğ™¼  ğŸŠ\n"
          bot_retor+=" SU MEMBRESIA HA FINALIZADO POR CHECK ID\n"
          bot_retor+=" FIN DE CONTRADO : $(date '+%C%y-%m-%d') - $(date +%R) \n"
          bot_retor+=" SI DESEAS APELAR TU CONTRADO, CONTACTA CON $(cat < /etc/ADM-db/resell)\n"
          bot_retor+=" $LINE\n"
          bot_retor+=" ADQUIERE TU MEMBRESIA DESDE @$(ShellBot.username) , DIGITANDO /prices \n"
          bot_retor+=" RECUERDA MANTENER TU CAPTURA DE PAGO, PARA ALGUN RECLAMO!\n"
          bot_retor+=" $LINE\n"
msj_add ${id}
done
}
done
[[ -z ${callback_query_from_username} ]] && nUSER=${message_from_username} || nUSER=${callback_query_from_username}
[[ -z ${callback_query_from_first_name} ]] && firsnme="${message_from_first_name}" || firsnme="${callback_query_from_first_name}"
[[ -z ${callback_query_from_last_name} ]] && lastnme="${message_from_last_name}" || lastnme="${callback_query_from_last_name}"
		  bot_retor=" âœ‰ï¸ ESTIMADO @${nUSER} SU REGISTRO FUE APROBADO  âœ‰ï¸ \n"
		  bot_retor+=" $LINE\n"
          bot_retor+=" EL ADM $(cat < /etc/ADM-db/resell) APROBO TU SOLICITUD\n"
          bot_retor+="  â˜ºï¸GRACIAS POR CONFIAR EN NOSOTROS â˜ºï¸\n"
          bot_retor+=" FECHA DE REGISTRO : $(date '+%C%y-%m-%d')|$(date +%R) \n VALIDO HASTA : ${valid}|$(date +%R)\n"
		  bot_retor+=" ğŸ†” : ${ids} | ğŸ” ACEPTADO ğŸ§¾\n"
		  bot_retor+="ğ™ƒSU RESELLER : ${firsnme} ${lastnm} \n"
          bot_retor+=" $LINE\n"
          bot_retor+=" GENERAR Key's usar el comando /keygen\n"
          bot_retor+=" Para MENU Digita el comando /menu\n"
          bot_retor+=" $LINE\n"
          bot_retor+=" CONTACTA ESCRIBE AL ADM $(cat < /etc/ADM-db/resell)\n SI NO OBTIENES RESPUESTA O SOLUCION CONTACTA A @ChumoGH "
          bot_retor+=" ADQUIERE TU MEMBRESIA DESDE @$(ShellBot.username) , DIGITANDO /prices \n"
          bot_retor+=" RECUERDA MANTENER TU CAPTURA DE PAGO, PARA ALGUN RECLAMO!\n"
          bot_retor+=" $LINE\n"
      msj_fun
      msj_add ${ids}
      upfile_src
    } || {
          bot_retorno=" âœ‰ï¸ ====NOTIFICACION==== âœ‰ï¸ \n"
          bot_retorno+="$LINE\n"
          bot_retorno+="Este ID ya esta Registrado\n"
          bot_retorno+="  âŒ ID NO REGISTRADO âŒ\n"
          bot_retorno+="$LINE\n"
          bot_retorno+="        âšœ Power by @ChumoGH âšœ\n"
          bot_retorno+="$LINE\n"
      msj_fun
    }
}

addID_reventa () {
bot_retorno=" -----ğŸ«¥ FUNCION EN ESTADO BETA ğŸ«¥ ------\n"
bot_retorno+=" $LINE\n"
bot_retorno+=" ID ${ids} VALIDO HASTA $(cat /etc/ADM-db/User-ID | grep ${ids} | awk '{print $3}')\n"
bot_retorno+=" âŒ NO REGISTRAR DUPLICADOS âŒ\n"
bot_retorno+=" SE PRESENTAN REGLAS DE ESTE FORMATO \n"
bot_retorno+=" 1 ID - Podra autorizar maximo 10 IDs  \n"
bot_retorno+="  Por maximo de 6 meses de tiempo! \n"
bot_retorno+="$LINE\n"
bot_retorno+="  EL ADMIN PRINCIPAL, PODRA CONTROLAR  \n"
bot_retorno+="         ESTAS AUTORIZACIONES  \n"
bot_retorno+="$LINE\n"
bot_retorno+="        âšœ Power by @ChumoGH âšœ\n"
bot_retorno+="$LINE\n"
msj_fun
}


addID_REV () {
      ids=$(echo ${message_text[$id]} | awk '{print $1}' | sed -e 's/[^a-z0-9 -]//ig')
      idc=$(echo ${message_text[$id]} | awk '{print $3}' | sed -e 's/[^a-z0-9 -]//ig')
      valid=$(date '+%C%y-%m-%d' -d " +$idc days")
	  [[ $(cat ${${CIDRESS}}|grep "$ids" ) = "" ]] && {
        echo "/${ids} | $valid" >> ${CID}
          bot_retorno="  ğŸŠ ğ™±ğš’ğšğš—ğšŸğšğš—ğš’ğšğš˜  @${callback_query_from_username}  ğšŠğš•  ğ™±ğš˜ğšğ™¶ğšğš—  ğ™²ğš‘ğšğš–ğš˜ğ™¶ğ™·-ğ™°ğ™³ğ™¼  ğŸŠ\n"
          bot_retorno+="$LINE\n"
          bot_retorno+=" New ID: ${ids}\n"
		  bot_retorno+=" FECHA DE REGISTRO : $(date '+%C%y-%m-%d')|$(date +%R) \n VALIDO HASTA : ${valid}|$(date +%R)\n"
          bot_retorno+="$LINE"
          bot_retorno+="  âœ… ID REGISTRADO âœ…\n"
          bot_retorno+="$LINE\n"
          bot_retorno+="        âšœ Power by @ChumoGH âšœ\n"
unset i
for i in $(cat /etc/ADM-db/User-ID | awk '{print $3}'); do 
[[ $(date -d $i +%s) -ge $(date -d $(date '+%C%y-%m-%d') +%s) ]] || {
idlog=$(cat /etc/ADM-db/User-ID | grep "$i" | awk '{print $1}' | sed -e 's/[^a-z0-9 -]//ig')
sed -i "/${idlog}/d" /etc/ADM-db/User-ID
          bot_retor="  ğŸŠ ğ™±ğš’ğšğš—ğšŸğšğš—ğš’ğšğš˜  Nuevamente ğšŠğš•  ğ™±ğš˜ğšğ™¶ğšğš—  ğ™²ğš‘ğšğš–ğš˜ğ™¶ğ™·-ğ™°ğ™³ğ™¼  ğŸŠ\n"
          bot_retor+="Desafortunadamente tu Membresia ha Finalizado\n"
          bot_retor+="Fecha de Corte : $i \n"
          bot_retor+="Si tienes Dudas, Contacta con $(cat < /etc/ADM-db/resell)\n"
          bot_retor+="$LINE\n"
          bot_retor+="Recuerda adquirir creditos, o Realizar una Colaboracion\n $(cat < /etc/mpayu) \n"
          bot_retor+="Para mantener tu acceso al BotGen Recuerda Mostrar tu Token de Donacion o Compra\n"
          bot_retor+="$LINE\n"
msj_add ${idlog}
}
done
          bot_retor="  âœ‰ï¸  ğ™±ğš’ğšğš—ğšŸğšğš—ğš’ğšğš˜  Nuevamente ğšŠğš•  ğ™±ğš˜ğšğ™¶ğšğš—  ğ™²ğš‘ğšğš–ğš˜ğ™¶ğ™·-ğ™°ğ™³ğ™¼  âœ‰ï¸ \n"
          bot_retor+="ğ™ƒğ™¤ğ™¡ğ™– ã€ ${callback_query_from_first_name} ${callback_query_from_last_name} ã€\n"
          bot_retor+=" EL ADM $(cat < /etc/ADM-db/resell) te autorizo\n"
          bot_retor+=" AUTORIZACION EXTENDIDA HASTA EL ${valid}\n"
          bot_retor+=" GENERAR Key's usar el comando /keygen\n"
          bot_retor+=" Para MENU Digita el comando /menu\n"
          bot_retor+=" $LINE\n"
          bot_retor+=" CONTACTA ESCRIBE AL ADM $(cat < /etc/ADM-db/resell)\n SI NO OBTIENES RESPUESTA O SOLUCION CONTACTA A @ChumoGH "
          bot_retor+=" ADQUIERE TU MEMBRESIA DESDE @$(ShellBot.username) , DIGITANDO /prices \n"
          bot_retor+=" RECUERDA MANTENER TU CAPTURA DE PAGO, PARA ALGUN RECLAMO!\n"
          bot_retor+="$LINE\n"
      msj_fun
      msj_add ${ids}
      upfile_src
    } || {
          bot_retorno=" -----ğŸ«¥ ID YA REGISTRADO ğŸ«¥ ------\n"
          bot_retorno+=" $LINE\n"
          bot_retorno+=" ID ${ids} VALIDO HASTA $(cat /etc/ADM-db/User-ID | grep ${ids} | awk '{print $3}')\n"
          bot_retorno+=" âŒ NO REGISTRAR DUPLICADOS âŒ\n"
          bot_retorno+="$LINE\n"
          bot_retorno+="        âšœ Power by @ChumoGH âšœ\n"
          bot_retorno+="$LINE\n"
      msj_fun
    }
}
